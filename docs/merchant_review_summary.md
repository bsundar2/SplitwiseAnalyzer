# Merchant Review System - Summary

## âœ… What's Been Created

You now have a complete merchant review and feedback system to improve merchant name extraction and categorization.

### New Files Created

| File | Purpose |
|------|---------|
| [src/merchant_review/run_review_workflow.py](../src/merchant_review/run_review_workflow.py) | **NEW** Unified workflow orchestrator - runs all steps |
| [src/merchant_review/generate_review_file.py](../src/merchant_review/generate_review_file.py) | Generate review CSV from processed transactions |
| [src/merchant_review/review_merchants.py](../src/merchant_review/review_merchants.py) | Interactive CLI tool for reviewing merchants |
| [src/merchant_review/apply_review_feedback.py](../src/merchant_review/apply_review_feedback.py) | Apply corrections to merchant lookup config |
| [docs/merchant_review_workflow.md](merchant_review_workflow.md) | Detailed workflow guide |
| [docs/review_demo.md](review_demo.md) | Example walkthrough |

### New Data Files (Generated)

| File | Purpose |
|------|---------|
| `data/processed/merchant_names_for_review.csv` | Generated by pipeline - merchants to review |
| `data/processed/merchant_review_feedback.json` | Your feedback (approved/corrected/skipped) |
| `data/processed/done_merchant_names_for_review.csv` | Archive of reviewed merchants |

## ğŸ¯ How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Run Pipeline      â”‚  Parses statements, extracts merchants
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ merchant_names_for_review  â”‚  â† You have 385 transactions
â”‚         .csv               â”‚    266 unique merchants
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Review Tool        â”‚  Interactive CLI to approve/correct
â”‚  (you use this)     â”‚  â€¢ [a] approve  â€¢ [c] correct
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ [s] skip     â€¢ [q] quit
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ merchant_review_feedback â”‚  Saves your corrections
â”‚        .json             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Apply Feedback     â”‚  Updates config with corrections
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ merchant_category_lookup.json  â”‚  â† Updated configuration
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Run Pipeline      â”‚  Uses updated config = better results!
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Quick Start

### Unified Workflow (Recommended)

```bash
# Run all steps automatically
python src/merchant_review/run_review_workflow.py \
  --processed-csv data/processed/your_statement.csv.processed.csv \
  --batch 20
```

### Individual Steps

#### 1. Generate Review File

```bash
python src/merchant_review/generate_review_file.py \
  --processed-csv data/processed/your_statement.csv.processed.csv \
  --output data/processed/merchant_names_for_review.csv
```

**Example output:**
```
MERCHANT REVIEW FILE PREVIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total transactions: 385
Unique merchants: 266

#1: Wow Auto Detailers
   Amount: $750.00 | Date: 2025-12-26
   Category: Transportation / Car
   Raw: ZII7NpgaiFd squareup.com/receipts...

#2: Google Fi
   Amount: $97.01 | Date: 2025-12-25
   Category: Uncategorized / General
   Raw: A1439NXM TELECOM SERVICE...
```

### 2. Start Reviewing (Interactive)

```bash
./review.sh start --batch 20
```

You'll see each merchant and can:
- **[a]** Approve if correct
- **[c]** Correct if wrong
- **[s]** Skip for now
- **[q]** Quit and save

### 3. Check Progress

```bash
./review.sh stats
```

### 4. Apply Corrections

```bash
# Preview first
./review.sh apply --dry-run

# Apply changes
./review.sh apply
```

### 5. Re-run Pipeline

```bash
export PYTHONPATH=/home/balaji94/PycharmProjects/SplitwiseImporter
source .venv/bin/activate
python src/pipeline.py --statement data/raw/your_statement.csv
```

Now the pipeline uses your corrections! ğŸ‰

## ğŸ“Š Current Status

**Your Review File:**
- âœ… File exists: `data/processed/merchant_names_for_review.csv`
- ğŸ“Š **385 total transactions**
- ğŸª **266 unique merchants**
- âœï¸ **0 reviewed so far** (ready to start!)

**Sample Merchants Waiting for Review:**
1. Wow Auto Detailers - $750.00 (Transportation/Car)
2. Google Fi - $97.01 (Uncategorized/General) â† needs category correction
3. Hulu - $2.99 (Utilities/TV/Phone/Internet)
4. Grab - $26.72 (Transportation/Taxi)
5. Guardian Health & Beauty - $16.07 (Life/Medical expenses)

## ğŸ’¡ Tips for Success

### Review in Batches
Don't try to do all 266 at once!
```bash
./review.sh start --batch 20  # Do 20 at a time
```

### Focus on Common Merchants
Merchants that appear frequently have the biggest impact. The review file contains all occurrences, so you'll naturally see high-frequency merchants more.

### Use Consistent Naming
- âœ… "Starbucks" not "STARBUCKS" or "Starbucks Coffee #1234"
- âœ… "Target" not "Target Corporation" or "Target - San Francisco"
- âœ… "Uber" not "Uber Technologies" or "Uber Trip"

### Common Categories
Based on your `amex_category_mapping.json`:
- **Food and drink** - Restaurants, grocery, coffee
- **Transportation** - Uber, Lyft, gas, parking
- **Utilities** - Phone, internet, streaming (Hulu, Netflix)
- **Life** - Healthcare, insurance, gym
- **Shopping** - Amazon, retail stores
- **Entertainment** - Movies, hobbies
- **General** - Miscellaneous

## ğŸ“– Documentation

- **Quick Start**: [review_demo.md](review_demo.md)
- **Full Guide**: [merchant_review_workflow.md](merchant_review_workflow.md)
- **Main README**: [../README.md](../README.md)

## ğŸ”„ Workflow Loop

1. **Review** â†’ 2. **Apply** â†’ 3. **Run Pipeline** â†’ 4. **See Improvements** â†’ (repeat)

The more you review, the smarter the system gets!

## âš¡ All Available Commands

```bash
./review.sh preview 10         # Preview 10 merchants
./review.sh start --batch 20   # Review 20 merchants
./review.sh continue 50        # Continue from #50
./review.sh stats              # Check progress
./review.sh apply --dry-run    # Preview changes
./review.sh apply              # Apply changes
./review.sh help               # Show help
```

## ğŸ¯ Your Next Step

Start reviewing your first batch:

```bash
./review.sh start --batch 20
```

Or preview first to see what's waiting:

```bash
./review.sh preview 5
```

Happy reviewing! ğŸš€
